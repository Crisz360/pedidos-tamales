<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>¡Pedido Recibido!</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Arial', sans-serif;
        }
        .success-container {
            max-width: 600px;
            margin: 50px auto;
            padding: 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            text-align: center;
        }
        .success-icon {
            font-size: 80px;
            color: #28a745;
            margin-bottom: 20px;
        }
        .order-summary {
            background-color: #f1f8ff;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }
        .product-img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 5px;
            margin-right: 10px;
        }
        .bank-details {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 15px;
        }
        .client-info {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .text-orange {
            color: #d35400;
        }
        .whatsapp-btn {
            background-color: #25D366;
            color: white;
            border: none;
            margin-top: 15px;
        }
        .whatsapp-btn:hover {
            background-color: #128C7E;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="success-container">
            <div class="success-icon">✓</div>
            <h1 class="mb-3 text-orange">¡Pedido recibido con éxito!</h1>
            <p class="lead">Gracias por tu compra. Hemos recibido tu pedido correctamente.</p>
            
            <div id="cliente-info" class="client-info"></div>
            
            <div class="order-summary">
                <h4 class="mb-3 text-orange">Resumen de tu pedido:</h4>
                <ul id="lista-pedido" class="list-unstyled mb-0"></ul>
                <hr>
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Total:</h5>
                    <h4 class="mb-0 text-success" id="total-pedido"></h4>
                </div>
                
                <div id="bank-details" class="bank-details mt-3" style="display: none;">
                    <h5 class="mb-2">Datos para transferencia:</h5>
                    <ul class="list-unstyled small">
                        <li><strong>Banco:</strong> BBVA</li>
                        <li><strong>Nombre:</strong> Tamales Doña Maria</li>
                        <li><strong>CLABE:</strong> 0123 4567 8910 1112</li>
                        <li><strong>Tarjeta:</strong> 4152 3134 5678 9012</li>
                    </ul>
                    <a href="https://wa.me/525512345678?text=Hola,%20acabo%20de%20hacer%20un%20pedido%20y%20quiero%20enviar%20el%20comprobante" 
                       class="btn whatsapp-btn">
                        <i class="bi bi-whatsapp"></i> Enviar comprobante por WhatsApp
                    </a>
                </div>
            </div>
            
            <p class="mt-4">Nos contactaremos contigo para confirmar los detalles de entrega.</p>
            <a href="index.html" class="btn btn-primary mt-3">Hacer otro pedido</a>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const pedidoStr = urlParams.get('pedido');
            
            if (pedidoStr) {
                try {
                    const pedido = JSON.parse(decodeURIComponent(pedidoStr));
                    
                    // Mostrar información del cliente
                    document.getElementById('cliente-info').innerHTML = `
                        <p><strong>Nombre:</strong> ${pedido.nombre || 'No proporcionado'}</p>
                        <p><strong>Teléfono:</strong> ${pedido.telefono || 'No proporcionado'}</p>
                        <p><strong>Método de pago:</strong> ${pedido.metodoPago === 'transferencia' ? 'Transferencia bancaria' : 'Efectivo al recibir'}</p>
                    `;
                    
                    // Mostrar productos pedidos
                    const listaPedido = document.getElementById('lista-pedido');
                    let htmlProductos = '';
                    let totalCalculado = 0;
                    
                    // Tamal Rojo
                    if (pedido.productos.rojo > 0) {
                        const subtotal = pedido.productos.rojo * 26;
                        totalCalculado += subtotal;
                        htmlProductos += `
                            <li class="d-flex align-items-center mb-3">
                                <img src="https://img.chilango.com/cdn-cgi/image/width=1200,quality=75,format=auto,onerror=redirect/2025/01/feria-del-tamal-2025-cdmx-monumento-a-la-revolucion.jpg" class="product-img">
                                <div>
                                    <div>${pedido.productos.rojo} x Tamal de Salsa Roja</div>
                                    <small class="text-muted">$${subtotal}</small>
                                </div>
                            </li>
                        `;
                    }
                    
                    // Tamal Verde
                    if (pedido.productos.verde > 0) {
                        const subtotal = pedido.productos.verde * 26;
                        totalCalculado += subtotal;
                        htmlProductos += `
                            <li class="d-flex align-items-center mb-3">
                                <img src="https://img.chilango.com/cdn-cgi/image/width=1200,quality=75,format=auto,onerror=redirect/2025/01/feria-del-tamal-2025-cdmx-monumento-a-la-revolucion.jpg" class="product-img">
                                <div>
                                    <div>${pedido.productos.verde} x Tamal de Salsa Verde</div>
                                    <small class="text-muted">$${subtotal}</small>
                                </div>
                            </li>
                        `;
                    }
                    
                    // Tamal Kool
                    if (pedido.productos.kool > 0) {
                        const subtotal = pedido.productos.kool * 27;
                        totalCalculado += subtotal;
                        htmlProductos += `
                            <li class="d-flex align-items-center mb-3">
                                <img src="https://img.chilango.com/cdn-cgi/image/width=1200,quality=75,format=auto,onerror=redirect/2025/01/feria-del-tamal-2025-cdmx-monumento-a-la-revolucion.jpg" class="product-img">
                                <div>
                                    <div>${pedido.productos.kool} x Tamal de Salsa Kool</div>
                                    <small class="text-muted">$${subtotal}</small>
                                </div>
                            </li>
                        `;
                    }
                    
                    listaPedido.innerHTML = htmlProductos;
                    document.getElementById('total-pedido').textContent = `$${totalCalculado}`;
                    
                    // Mostrar datos bancarios si es transferencia
                    if (pedido.metodoPago === 'transferencia') {
                        document.getElementById('bank-details').style.display = 'block';
                    }
                    
                } catch (e) {
                    console.error('Error al procesar el pedido:', e);
                    document.getElementById('cliente-info').innerHTML = `
                        <div class="alert alert-warning">
                            No pudimos cargar los detalles de tu pedido. Por favor contáctanos directamente al: <strong>55-1234-5678</strong>
                        </div>
                    `;
                }
            } else {
                document.getElementById('cliente-info').innerHTML = `
                    <div class="alert alert-warning">
                        No se recibieron datos del pedido. Por favor contáctanos directamente al: <strong>55-1234-5678</strong>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
